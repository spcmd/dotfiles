"                                      _
"         ___ _ __   ___ _ __ ___   __| |
"        / __| '_ \ / __| '_ ` _ \ / _` |
"        \__ | |_) | (__| | | | | | (_| |
"        |___| .__/ \___|_| |_| |_|\__,_|
"             |_|
"
"                 .vimperatorrc
"               Created by: spcmd
"           http://spcmd.github.io
"           https://github.com/spcmd
"           https://gist.github.com/spcmd

" {{{   Settings
"--------------------------------------------

colorscheme i3-blue
set hintchars=hjklasdfgrtzu
set editor="gvim -f"
let mapleader = "-"

"Hide navigation/url bar
set toolbars=nonavigation

"Load all Firefox page and help page in new tab
set newtab=all

" }}}
" {{{   Key mappings
"--------------------------------------------

"Do not paste&search
map p <Nop>

"Faster scrolling
nnoremap j 3j
nnoremap k 3k
nnoremap <C-j> <C-d>
nnoremap <C-k> <C-u>

"Tabs
nmap ú :tabnext<CR>
nmap ő :tabprevious<CR>
nmap á :tabmove +1<CR>
nmap é :tabmove -1<CR>

"History navigation
nmap , :back<CR>
nmap . :forward<CR>

"Quick select text in CARET/VISUAL mode: move to the beginning/end of line
vnoremap H ^
vnoremap L $

"Escape from focused textarea
inoremap <C-e> <C-[>

"Quick help
nnoremap h :help<Space>

"Context menu
nnoremap cc ;c

"vimpv.js (play videos with mpv)
nmap m ;m

"Search highlight
nmap <leader>h :noh<CR>

"Bookmarks toggle
nmap <C-b> :ignorekeys<CR> :sidebar Bookmarks<CR>

"Select ALL
nnoremap <C-a> i<C-a>
inoremap <C-a> <Ins><C-a><Ins>

"Dict lookup
nmap <leader>d :dict<CR>

"Wikipedia lookup
nmap <leader>w :wiki<CR>

"Youtube lookup
nmap <leader>y :yt<CR>

" }}}
" {{{   Bookmarks
"--------------------------------------------

nmap gh :tabnew<CR>
nmap gd :open github.com/spcmd/dotfiles<CR>
nmap gl :open logout.hu/forum/index.html<CR>
nmap gy :open youtube.com/feed/subscriptions<CR>
nmap gp :open port.hu/tv/pls/tv/oldtv.prog<CR>

command! bmkLogout :open logout.hu/forum/index.html
command! bmkGithubDotfiles :open github.com/spcmd/dotfiles
command! bmkGithubScripts :open github.com/spcmd/Scripts
command! bmkGithubthemes :open github.com/spcmd/themes
command! bmkYoutube :open youtube.com/feed/subscriptions
command! bmkIMDB :open imdb.com
command! bmkPort :open port.hu/tv/pls/tv/oldtv.prog

" }}}
" {{{   Commands
"--------------------------------------------

"Quick open Addons
command! -description="Open addons page (custom command)" AA :tabopen about:addons

"Toggle userstyle (stylish.js plugin)
command! -description="Toggle Stylish userstyle for this page (custom command)" ST :stylish toggle

"Open private window
command! -description="Open private window (custom command)" private :normal i<C-S-p>

"Source this config
command! -description="Source .vimperatorrc (custom command)" RR source ~/.vimperatorrc

"PH/Logout search integration
command! -description="PH! Fórum kereső: keresés a topikban" -nargs=* ph js window.content.window.location = window.content.window.location.href.match( /^(http.+\/)[^\/]+$/ )[1] +'keres.php?type=-&stext=<args>';

"PH/Logout comment search
command! -description="PH! Fórum kereső: keresés a topikban (csak a saját hozzászólásaim közt)" -nargs=* phmy js window.content.window.location = window.content.window.location.href.match( /^(http.+\/)[^\/]+$/ )[1] +'keres.php?type=-&stext=<args>&suser=spammer';

"Lookup selected text in Dict
command! -description="Lookup the selected text in a dictionary" dict js window.content.window.open("http://szotar.sztaki.hu/search?searchWord="+window.content.window.getSelection().toString(), '_blank')

"Lookup selected text in Wikipedia
command! -description="Lookup the selected text in wikipedia" wiki js window.content.window.open("https://en.wikipedia.org/wiki/"+window.content.window.getSelection().toString(), '_blank')

"Lookup selected text in Wikipedia
command! -description="Lookup the selected text in youtube" yt js window.content.window.open("https://www.youtube.com/results?search_query="+window.content.window.getSelection().toString(), '_blank')

" }}}
" {{{   Autocommands
"--------------------------------------------

"Autocommands won't be refreshed properly while Firefox is running!
"To source/refresh them, we need to restart Firefox.

"Enable angol-magyar-szotar.hu site functions with Adblocker
"http://stackoverflow.com/questions/15995201/how-do-i-getelementbyid-in-vimperator
autocmd PageLoad angol-magyar-szotar\.hu js window.content.window.document.getElementById("forditInput").removeAttribute('disabled'); window.content.window.document.getElementById("ForditGomb").removeAttribute('disabled');

"Redirect IT Cafe, Prohardver, Mobilarena, Gamepod forum topic links to Logout
autocmd LocationChange ^http:\/\/(itcafe|prohardver|mobilarena|gamepod).*\/tema\/ js window.content.window.location = window.content.window.location.href.replace(/itcafe|prohardver|mobilarena|gamepod/, 'logout')

"Redirect Youtube main page to subscriptions page
autocmd DOMLoad ^(http|https):\/\/(www)?.youtube.com\/?$ js window.content.window.location = "https://www.youtube.com/feed/subscriptions"

" }}}
