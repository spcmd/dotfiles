"                                      _
"         ___ _ __   ___ _ __ ___   __| |
"        / __| '_ \ / __| '_ ` _ \ / _` |
"        \__ | |_) | (__| | | | | | (_| |
"        |___| .__/ \___|_| |_| |_|\__,_|
"             |_|
"
"                 .vimperatorrc
"               Created by: spcmd
"           http://spcmd.github.io
"           https://github.com/spcmd
"           https://gist.github.com/spcmd

" {{{   Settings
"--------------------------------------------

colorscheme i3-blue
set hintchars=hjklasdfgrtzu
set titlestring=
set editor="gvim -f"
let mapleader = "-"

"Hide navigation/url bar
set toolbars=nonavigation

"Load all Firefox page and help page in new tab
set newtab=all

" }}}
" {{{   Key mappings
"--------------------------------------------

"Do not paste&search
map p <Nop>

"Faster scrolling
nnoremap j 3j
nnoremap k 3k
nnoremap <C-j> <C-d>
nnoremap <C-k> <C-u>

"Tabs
nnoremap ú :tabnext<CR>
nnoremap ő :tabprevious<CR>
nnoremap á :tabmove +1<CR>
nnoremap é :tabmove -1<CR>

"History navigation
nnoremap , :back<CR>
nnoremap . :forward<CR>

"Quick select text in CARET/VISUAL mode: move to the beginning/end of line
vnoremap H ^
vnoremap L $

"Escape from focused textarea
inoremap <C-e> <C-[>

"Quick help
nnoremap h :help<Space>

"Context menu
nnoremap cc ;c

"Bookmarks toggle
nnoremap <C-b> :ignorekeys<CR> :sidebar Bookmarks<CR>

"Select ALL
nnoremap <C-a> i<C-a>
inoremap <C-a> <Ins><C-a><Ins>

"vimpv.js (play videos with mpv)
nnoremap m ;m

"vimphelper.sh
nmap ? :silent execute "!vimphint.sh"<CR>

"Search highlight
nmap <leader>h :noh<CR>

"Translate the selected text with Translate Shell (https://github.com/soimort/translate-shell)
nmap <leader>t :trans<CR>
nmap <leader>T :transfull<CR>

"Sztaki lookup
nmap <leader>s :sztaki<CR>

"Wikipedia lookup
nmap <leader>w :wiki<CR>

"Youtube lookup
nmap <leader>y :yt<CR>

"PH linkformat
nmap Y :phlinkformat<CR>

"Search for the highlighted text on page & copy to the clipboard
nmap <leader>f :js var selectedText = window.content.window.getSelection().toString(); window.content.window.find(selectedText); util.copyToClipboard(selectedText, true); liberator.echo("Searching for highlighted text: "+selectedText+" (copied to the clipboard)")<CR>
 

" }}}
" {{{   Go To (Bookmarks)
"--------------------------------------------

nmap gh :tabnew<CR>
nmap gl :open logout.hu/forum/index.html<CR>
nmap gd :open github.com/spcmd/dotfiles<CR>
nmap gs :open github.com/spcmd/Scripts<CR>
nmap gy :open youtube.com/feed/subscriptions<CR>
nmap gp :open http://www.port.hu/pls/tv/tv.prog?i_layout_id=1<CR>

" }}}
" {{{   Commands
"--------------------------------------------

"Quick open Addons
command! AA -description="Open addons page (custom command)" :tabopen about:addons

"Toggle userstyle (stylish.js plugin)
command! ST -description="Toggle Stylish userstyle for this page (custom command)" :stylish toggle

"Open private window
command! private -description="Open private window (custom command)" :normal i<C-S-p>

"Source this config
command! RR -description="Source .vimperatorrc (custom command)" source ~/.vimperatorrc

"PH/Logout search integration
command! ph -description="PH! Fórum kereső: keresés a topikban" -nargs=* js window.content.window.location = window.content.window.location.href.match( /^(http.+\/)[^\/]+$/ )[1] +'keres.php?type=-&stext=<args>';

"PH/Logout comment search
command! phmy -description="PH! Fórum kereső: keresés a topikban (csak a saját hozzászólásaim közt)" -nargs=* js window.content.window.location = window.content.window.location.href.match( /^(http.+\/)[^\/]+$/ )[1] +'keres.php?type=-&stext=<args>&suser=spammer';

"Translate the selected text with Translate Shell (https://github.com/soimort/translate-shell)
command! trans -description="Translate the selected text with Translate Shell" execute "!trans -b :hu "+window.content.window.getSelection().toString()

"Translate the selected text with Translate Shell (https://github.com/soimort/translate-shell)
command! transfull -description="Translate the selected text with Translate Shell" silent execute "!urxvtc --hold -e trans :hu "+window.content.window.getSelection().toString()

"Translate page with Google Translate
command! transpage -description="Translate page with Google Translate" js window.content.window.location = "https://translate.google.com/translate?sl=auto&tl=en&js=y&hl=en&ie=UTF-8&u="+window.content.window.location

"Lookup selected text in Sztaki
command! sztaki -description="Lookup the selected text in a dictionary" js window.content.window.open("http://szotar.sztaki.hu/search?searchWord="+window.content.window.getSelection().toString(), '_blank')

"Lookup selected text in Wikipedia
command! wiki -description="Lookup the selected text in wikipedia" js window.content.window.open("https://en.wikipedia.org/wiki/"+window.content.window.getSelection().toString(), '_blank')

"Lookup selected text in Youtube
command! yt -description="Lookup the selected text in youtube" js window.content.window.open("https://www.youtube.com/results?search_query="+window.content.window.getSelection().toString(), '_blank')

"Lookup selected text in Urbandictionary
command! urbandict -description="Lookup the selected text in urbandictionary" js window.content.window.open("http://www.urbandictionary.com/define.php?term="+window.content.window.getSelection().toString(), '_blank')

" }}}
" {{{   Autocommands
"--------------------------------------------

"Autocommands won't be refreshed properly while Firefox is running!
"To source/refresh them, we need to restart Firefox.

"Enable angol-magyar-szotar.hu site functions with Adblocker
"http://stackoverflow.com/questions/15995201/how-do-i-getelementbyid-in-vimperator
autocmd PageLoad angol-magyar-szotar\.hu js window.content.window.document.getElementById("forditInput").removeAttribute('disabled'); window.content.window.document.getElementById("ForditGomb").removeAttribute('disabled');

"Redirect IT Cafe, Prohardver, Mobilarena, Gamepod forum topic links to Logout
autocmd LocationChange ^http:\/\/(itcafe|prohardver|mobilarena|gamepod).*\/tema\/ js window.content.window.location = window.content.window.location.href.replace(/itcafe|prohardver|mobilarena|gamepod/, 'logout')

"Redirect Youtube main page to subscriptions page
autocmd DOMLoad ^(http|https):\/\/(www)?.youtube.com\/?$ js window.content.window.location = "https://www.youtube.com/feed/subscriptions"

" }}}
